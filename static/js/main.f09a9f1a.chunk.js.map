{"version":3,"sources":["lib/TranscriptEditor/TimedTextEditor/TimedTextEditor.js","lib/TranscriptEditor/MediaController/ProgressBar/ProgressBar.js","lib/TranscriptEditor/MediaController/PlayerControls/PlayerControls.js","lib/TranscriptEditor/MediaController/MediaController.js","lib/TranscriptEditor/MediaPreview/MediaPreview.js","lib/TranscriptEditor/TranscriptEditor.js","index.js","lib/TranscriptEditor/TranscriptEditor.module.css","lib/TranscriptEditor/TimedTextEditor/adapters/bbc-kaldi/index.js","lib/TranscriptEditor/MediaPreview/MediaPreview.module.css","index.module.css"],"names":["TimedTextEditor","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","state","editorState","EditorState","createEmpty","transcriptData","onChange","setState","loadData","blocks","bbcKaldiToDraft","contentState","convertFromRaw","entityMap","createWithContent","react_default","a","createElement","Draft","React","Component","ProgressBar","PlayerControls","MediaController","MediaController_ProgressBar_ProgressBar","MediaController_PlayerControls_PlayerControls","MediaPreview","videoRef","createRef","className","styles","videoSection","id","playsInline","controls","src","mediaUrl","type","data-testid","ref","TranscriptEditor","container","header","TranscriptEditor_MediaController_MediaController","nav","TranscriptEditor_MediaPreview_MediaPreview","main","TranscriptEditor_TimedTextEditor_TimedTextEditor","aside","footer","render","lib_TranscriptEditor_TranscriptEditor","kaldiTedTalkTranscript","document","getElementById","module","exports","bbcKaldiJson","results","words","paragraph","text","forEach","word","test","punct","push","groupWordsInParagraphs","retval","draftJsContentBlockParagraph","join","data","speaker","entityRanges"],"mappings":"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","file":"static/js/main.f09a9f1a.chunk.js","sourcesContent":["import React from 'react';\nimport \n// Draft,\n    {\n    Editor,\n    EditorState,\n    // ContentState,\n    convertFromRaw,\n  } from 'draft-js';\n\nimport styles from './TimedTextEditor.module.css';\n\nimport bbcKaldiToDraft from './adapters/bbc-kaldi/index.js';\n\n\nclass TimedTextEditor extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            editorState: EditorState.createEmpty(),\n            transcriptData: this.props.transcriptData\n        };\n    \n        this.onChange = editorState => this.setState({ editorState });\n      \n    }\n    componentDidMount(){\n        this.loadData();\n    }\n    \n    loadData() {\n        let blocks = bbcKaldiToDraft(this.props.transcriptData);\n\n        const entityMap = {};\n\n        const contentState = convertFromRaw({ blocks, entityMap });\n        const editorState = EditorState.createWithContent(contentState);\n\n        this.setState({ editorState });\n    }\n    \n    render() {\n        return (\n        <section>\n            <Editor editorState={this.state.editorState} onChange={this.onChange} />\n            {/* <button onClick={() => this.loadData()}>load data</button> */}\n        </section>\n        );\n    }\n}\n\nexport default TimedTextEditor;\n","import React from 'react';\n\nclass ProgressBar extends React.Component {\n    render() {\n      return <h3>ProgressBar</h3>;\n    }\n  }\n\nexport default ProgressBar;","import React from 'react';\n\nclass PlayerControls extends React.Component {\n    render() {\n      return <h3>PlayerControls</h3>;\n    }\n  }\n\nexport default PlayerControls;","import React from 'react';\n\n\nimport ProgressBar from \"./ProgressBar/ProgressBar\";\nimport PlayerControls from \"./PlayerControls/PlayerControls\";\n\nclass MediaController extends React.Component {\n    render() {\n      return (\n          <div>\n            <h2>MediaController</h2>\n            <ProgressBar/>\n           \n            <PlayerControls/>\n        </div>\n      );\n    }\n  }\n\nexport default MediaController;","import React from 'react';\nimport styles from './MediaPreview.module.css';\n\n// inspired by https://github.com/bbc/nm2/blob/master/src/components/chapter/video/Video.jsx\n\nclass MediaPreview extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.videoRef = React.createRef();\n  }\n    render() {\n      return (\n        <section className={styles.videoSection}>\n         <video\n            id=\"video\"\n            playsInline\n            // autoPlay\n            controls\n            src={this.props.mediaUrl}\n            type=\"video/mp4\"\n            data-testid=\"media-player-id\"\n            ref={this.videoRef}\n          />\n        </section>\n      );\n    }\n  }\n\nexport default MediaPreview;","import React from 'react';\nimport styles from  \"./TranscriptEditor.module.css\";\n\nimport TimedTextEditor from \"./TimedTextEditor/TimedTextEditor\";\nimport MediaController from \"./MediaController/MediaController\";\nimport MediaPreview from \"./MediaPreview/MediaPreview\";\n\nclass TranscriptEditor extends React.Component {\n\n    render() {\n        return (\n            <section className={styles.container}>\n                <header className={styles.header}>\n                    <MediaController \n                    mediaUrl={this.props.mediaUrl} \n                    />\n                </header>\n                <nav  className={styles.nav}>\n                    <MediaPreview \n                    mediaUrl={this.props.mediaUrl}            \n                    />\n                </nav>\n                <main  className={styles.main}>\n                    <TimedTextEditor\n                    transcriptData={this.props.transcriptData}\n                    />\n                </main>\n                <aside className={styles.aside}>Settings</aside>\n                <footer className={styles.footer}>Footer</footer>\n        </section>\n        );\n    }\n}\n\nexport default TranscriptEditor;","import React from 'react';\nimport { render } from \"react-dom\";\nimport { TranscriptEditor } from \"./lib\";\n// import kaldiTranscript from './sample-data/kaldi-transcription-20181029235300.json';\nimport kaldiTedTalkTranscript from './sample-data/KateDarling_2018S-bbc-kaldi.json';\n\nimport styles from './index.module.css';\n\nconst tedTalkVideoUrl = 'https://download.ted.com/talks/KateDarling_2018S-950k.mp4';\n\nconst App = () => (\n  <div className={styles.container}>\n    <TranscriptEditor \n      transcriptData={kaldiTedTalkTranscript} \n      mediaUrl={tedTalkVideoUrl}\n    />\n  </div>\n);\n\nrender(<App />, document.getElementById(\"root\"));\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"TranscriptEditor_container__1xHvx\",\"nav\":\"TranscriptEditor_nav__19yQR\",\"header\":\"TranscriptEditor_header__A5dxc\",\"main\":\"TranscriptEditor_main__3i6K9\",\"aside\":\"TranscriptEditor_aside__1VrzG\",\"footer\":\"TranscriptEditor_footer__3Tsod\"};","/**\n * Convert BBC Kaldi json\n ```\n {\n    \"action\": \"audio-transcribe\",\n    \"retval\": {\n      \"status\": true,\n      \"wonid\": \"octo:2692ea33-d595-41d8-bfd5-aa7f2d2f89ee\",\n      \"punct\": \"There is a day. About ten years ago when  ...\",\n      \"words\": [\n        {\n          \"start\": 13.02,\n          \"confidence\": 0.68,\n          \"end\": 13.17,\n          \"word\": \"there\",\n          \"punct\": \"There\",\n          \"index\": 0\n        },\n        {\n          \"start\": 13.17,\n          \"confidence\": 0.61,\n          \"end\": 13.38,\n          \"word\": \"is\",\n          \"punct\": \"is\",\n          \"index\": 1\n        },\n```\n * \n * into \n * \n ```\n const blocks = [\n        {\n            text: 'Hello',\n            type: 'paragraph',\n            data: {\n            speaker: 'Foo',\n            },\n            entityRanges: [],\n        },\n        {\n            text: 'World',\n            type: 'paragraph',\n            data: {\n            speaker: 'Bar',\n            },\n            entityRanges: [],\n        },\n        ];\n```\n * \n */\n\n\nfunction bbcKaldiToDraft(bbcKaldiJson){\n    let results = [];\n   let wordsByParagraphs = groupWordsInParagraphs(bbcKaldiJson.retval.words);\n   wordsByParagraphs.forEach((paragraph)=>{\n        let draftJsContentBlockParagraph = {\n            text: paragraph.text.join(' '),\n            type: 'paragraph',\n            data: {\n            speaker: 'TBC',\n            },\n            entityRanges: []\n        }\n        results.push(draftJsContentBlockParagraph);\n    })\n\n\n    return results;\n}\n\n/**\n * groups words list from kaldi transcript based on punctuation.\n * @todo To be more accurate, should introduce an honorifics library to do the splitting of the words.\n * @param {array} words - array of words opbjects from kaldi transcript\n */ \nfunction groupWordsInParagraphs(words){\n    let results = [];\n    let paragraph = {words:[], text:[]};\n    words.forEach((word) => {\n        // if word contains punctuation\n        if(/[.?!]/.test(word.punct)){\n            paragraph.words.push(word);\n            paragraph.text.push(word.punct);\n            results.push(paragraph);\n            // reset paragraph \n            paragraph = {words:[], text:[]};\n        }else{\n            paragraph.words.push(word);\n            paragraph.text.push(word.punct);\n        }\n    });\n    return results\n}\n\n module.exports = bbcKaldiToDraft;","// extracted by mini-css-extract-plugin\nmodule.exports = {\"videoSection\":\"MediaPreview_videoSection__3uEmr\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"src_container__2-l5-\"};"],"sourceRoot":""}